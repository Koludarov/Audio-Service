# Веб-сервис для сохранения и скачивания аудиозаписей
Данный веб-сервис предоставляет API для создания пользователей, сохранения аудиозаписей в формате WAV, их преобразования в MP3, а также предоставления ссылок для скачивания аудиозаписей.

## Установка и настройка
Установите Docker и Docker Compose, если они еще не установлены.

1. Клонируйте данный репозиторий:

   ```bash
   git clone https://github.com/Koludarov/Audio-Service
   cd Audio-Service
    ```
2. База данных PostgreSQL будет запущена автоматически с использованием Docker Compose. Здесь вы можете настроить логин, пароль и имя базы данных PostgreSQL по вашему усмотрению. Для этого нужно изменить следующие значения в файле `.env`:

- `DB_USER`: имя пользователя для подключения к базе данных.
- `DB_PASSWORD`: пароль пользователя для подключения к базе данных.
- `DB_NAME`: название базы данных.

3. Запустите контейнер с PostgreSQL и веб-сервисом с помощью Docker Compose:
    
   ```bash
      docker-compose up -d
    ```
   Это запустит контейнер базы данных PostgreSQL и контейнер приложения Flask.
4. Веб-сервис будет доступен по адресу http://localhost:8000.

## Использование API
Создание пользователя

Endpoint: `POST /users`

Создает нового пользователя.

Тело запроса:
   ```json
{
  "name": "John Doe"
}
   ```
Пример ответа:

   ```json
{
  "token":"072778ca-af24-474f-85b0-bf6eff3fc1f3",
  "user_id":2
}
   ```
Запрос через терминал:
```bash
curl -X POST -H "Content-Type: application/json" -d '{"name": "Wav Hater"}' http://localhost:8000/users
```

Добавление аудиозаписи

Endpoint: `POST /records`

Добавляет аудиозапись для указанного пользователя.

Тело запроса:
   ```json
{
  "user_id": 1,
  "token": "072778ca-af24-474f-85b0-bf6eff3fc1f3",
  "audio": <файл аудиозаписи в формате WAV>
}
   ```
Пример ответа:

   ```json
{
  "download_url": "http://localhost:8000/record?id=13&user=2"
}

   ```
Запрос через терминал:
```bash
curl -X POST -F "user_id=<user_id>" -F "token=<token>" -F "audio=@<audio_file.wav>" http://localhost:8000/records
```
Для этого запроса, вы должны находиться в одной директории с wav файлом или верно указать путь. А также заменить параметры `<user_id>`,`<token>`,`<audio_file.wav>` на существующие.


## Доступ к аудиозаписи

Endpoint: `GET /record`

Предоставляет возможность скачать аудиозапись по ссылке.

Параметры запроса:

* `id` (обязательный): идентификатор аудиозаписи
* `user` (обязательный): идентификатор пользователя

Пример ссылки для скачивания:

http://localhost:8000/record?id=13&user=2

Запрос через терминал:
```bash
curl -O -J <download_url>
```
В этом запрос нужно заменить параметр `<download_url>`.
## Завершение работы
Чтобы остановить контейнеры, выполните следующую команду:
   ```bash
   docker-compose down
   ```